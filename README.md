# SubConverter Go 版本\n\n[![CI/CD Pipeline](https://github.com/username/subconverter-go/actions/workflows/ci.yml/badge.svg)](https://github.com/username/subconverter-go/actions/workflows/ci.yml)\n[![Go Report Card](https://goreportcard.com/badge/github.com/username/subconverter-go)](https://goreportcard.com/report/github.com/username/subconverter-go)\n[![codecov](https://codecov.io/gh/username/subconverter-go/branch/main/graph/badge.svg)](https://codecov.io/gh/username/subconverter-go)\n[![License](https://img.shields.io/github/license/username/subconverter-go)](LICENSE)\n[![GitHub release](https://img.shields.io/github/release/username/subconverter-go.svg)](https://github.com/username/subconverter-go/releases)\n\n**SubConverter** 的 Go 语言重写版本，提供高性能的订阅转换服务，完全兼容原有 C++ 版本的 API 和功能。\n\n## 📋 特性\n\n- 🚀 **高性能**: 利用 Go 并发特性，处理速度显著提升\n- 🔄 **完全兼容**: 与 C++ 版本 100% API 兼容，无缝迁移\n- 📦 **单文件部署**: 编译后的单个可执行文件，部署简单\n- 🐳 **容器化支持**: 提供 Docker 镜像，支持容器化部署\n- 🌐 **多客户端支持**: 支持 Clash、Surge、QuantumultX、Loon、SingBox 等\n- 🎯 **模板系统**: 兼容现有 Jinja2 模板，支持自定义配置\n- 📊 **监控集成**: 内置 Prometheus 指标和健康检查\n- 🔒 **安全加固**: 支持访问令牌、速率限制等安全特性\n\n## 📖 支持的客户端\n\n| 客户端 | 配置格式 | 状态 |\n|--------|----------|------|\n| Clash | YAML | ✅ 支持 |\n| Surge | Config | ✅ 支持 |\n| QuantumultX | Config | ✅ 支持 |\n| Loon | Config | ✅ 支持 |\n| SingBox | JSON | ✅ 支持 |\n| Shadowrocket | Config | 🚧 开发中 |\n\n## 🚀 快速开始\n\n### 下载预编译版本\n\n 从 [Releases](https://github.com/username/subconverter-go/releases) 页面下载适合您系统的预编译版本。\n\n### 使用 Docker\n\n`bash\n# 拉取镜像\ndocker pull ghcr.io/username/subconverter-go:latest\n\n# 运行容器\ndocker run -d \\\n  --name subconverter-go \\\n  -p 25500:25500 \\\n  ghcr.io/username/subconverter-go:latest\n`\n\n### 从源码构建\n\n`bash\n# 克隆仓库\ngit clone https://github.com/username/subconverter-go.git\ncd subconverter-go\n\n# 构建\nmake build\n\n# 运行\n./bin/subconverter-go\n`\n\n## 🔧 配置\n\n### 环境变量配置\n\n`bash\n# 服务配置\nexport SC_SERVER_HOST=0.0.0.0\nexport SC_SERVER_PORT=25500\n\n# 日志配置\nexport SC_LOG_LEVEL=info\nexport SC_LOG_FORMAT=json\n\n# 缓存配置\nexport SC_CACHE_ENABLE=true\nexport SC_CACHE_DEFAULT_TTL=10m\n\n# 安全配置\nexport SC_ACCESS_TOKEN=your-secret-token\nexport SC_RATE_LIMIT=100\n`\n\n### 配置文件\n\n 创建 `configs/config.yaml` 文件：\n\n`yaml\nserver:\n  host: \"0.0.0.0\"\n  port: 25500\n\nlog:\n  level: \"info\"\n  format: \"text\"\n\ncache:\n  enable: true\n  default_ttl: \"10m\"\n\n# 更多配置选项请参考 configs/config.yaml\n`\n\n## 📚 API 文档\n\n### 订阅转换\n\n`bash\n# 基础转换\ncurl \"http://localhost:25500/sub?target=clash&url=https://your-subscription-url\"\n\n# 带配置文件\ncurl \"http://localhost:25500/sub?target=surge&url=https://your-subscription-url&config=https://config-url\"\n\n# 节点过滤\ncurl \"http://localhost:25500/sub?target=clash&url=https://your-subscription-url&include=香港&exclude=测试\"\n`\n\n### 支持的参数\n\n| 参数 | 描述 | 示例 |\n|------|------|------|\n| `target` | 目标客户端类型 | `clash`, `surge`, `quantumult-x` |\n| `url` | 订阅链接 | `https://example.com/sub` |\n| `config` | 外部配置文件 | `https://example.com/config.ini` |\n| `include` | 包含过滤器 | `香港|美国` |\n| `exclude` | 排除过滤器 | `测试|到期` |\n| `emoji` | 添加 emoji | `true`, `false` |\n| `sort` | 节点排序 | `true`, `false` |\n\n### 其他 API\n\n`bash\n# 获取版本信息\ncurl \"http://localhost:25500/version\"\n\n# 健康检查\ncurl \"http://localhost:25500/health\"\n\n# 获取规则集\ncurl \"http://localhost:25500/getruleset?type=clash&group=media\"\n\n# Prometheus 指标\ncurl \"http://localhost:25500/metrics\"\n`\n\n## 🛠️ 开发\n\n### 环境要求\n\n- Go 1.19+\n- Make\n- Docker (可选)\n\n### 开发命令\n\n`bash\n# 安装依赖\nmake deps\n\n# 代码检查\nmake lint\n\n# 运行测试\nmake test\n\n# 启动开发模式（热重载）\nmake dev\n\n# 构建所有平台版本\nmake build-all\n\n# 构建 Docker 镜像\nmake docker-build\n`\n\n### 项目结构\n\n`\nsubconverter-go/\n├── cmd/                    # 应用程序入口\n├── internal/              # 内部包\n│   ├── api/               # HTTP API 层\n│   ├── service/           # 业务逻辑层\n│   ├── parser/            # 解析器模块\n│   ├── generator/         # 生成器模块\n│   └── config/            # 配置管理\n├── pkg/                   # 可对外暴露的包\n│   ├── models/            # 数据模型\n│   └── types/             # 类型定义\n├── configs/               # 配置文件\n├── templates/             # 模板文件\n├── assets/                # 静态资源\n└── test/                  # 测试文件\n`\n\n## 🐳 Docker 部署\n\n### 基础部署\n\n`bash\n# 使用 docker-compose\ncd docker\ndocker-compose up -d\n`\n\n### 生产环境部署\n\n`yaml\n# docker-compose.yml\nversion: '3.8'\nservices:\n  subconverter-go:\n    image: ghcr.io/username/subconverter-go:latest\n    ports:\n      - \"25500:25500\"\n    environment:\n      - SC_LOG_LEVEL=info\n      - SC_CACHE_ENABLE=true\n      - SC_ACCESS_TOKEN=your-secret-token\n    volumes:\n      - ./config.yaml:/app/configs/config.yaml:ro\n      - ./templates:/app/templates:ro\n    restart: unless-stopped\n`\n\n## ⚡ 性能优化\n\n### 缓存配置\n\n`yaml\ncache:\n  enable: true\n  default_ttl: \"10m\"\n  max_entries: 1000\n  cleanup_time: \"1m\"\n`\n\n### 并发设置\n\n`yaml\nserver:\n  max_connections: 1000\n  read_timeout: \"30s\"\n  write_timeout: \"30s\"\n`\n\n### 资源限制\n\n`bash\n# Docker 资源限制\ndocker run -d \\\n  --name subconverter-go \\\n  --memory=512m \\\n  --cpus=1.0 \\\n  -p 25500:25500 \\\n  ghcr.io/username/subconverter-go:latest\n`\n\n## 🔒 安全建议\n\n1. **使用访问令牌**: 设置 `SC_ACCESS_TOKEN` 环境变量\n2. **启用速率限制**: 配置 `rate_limit` 参数\n3. **HTTPS 部署**: 使用反向代理启用 HTTPS\n4. **定期更新**: 保持版本更新以获取安全修复\n\n## 📈 监控\n\n### Prometheus 指标\n\n 访问 `http://localhost:25500/metrics` 获取监控指标：\n\n- `subconverter_requests_total`: 请求总数\n- `subconverter_request_duration_seconds`: 请求处理时间\n- `subconverter_cache_hits_total`: 缓存命中次数\n- `subconverter_active_connections`: 活跃连接数\n\n### 健康检查\n\n```bash\n# 健康检查端点\ncurl http://localhost:25500/health\n\n# 响应示例\n{\n \"status\": \"ok\",\n \"time\": 1640995200,\n
